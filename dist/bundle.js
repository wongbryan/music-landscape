function keyToCode(e){return Object.keys(KEYCODES)[Object.values(KEYCODES).indexOf(e)]}function codeToKey(e){return KEYCODES[e]}function resize(){camera.aspect=window.innerWidth/window.innerHeight,camera.updateProjectionMatrix(),renderer.setSize(window.innerWidth,window.innerHeight)}function updateCamera(){pov?camera.position.copy(Avatar.position).add(new THREE.Vector3(0,5,10)):(camera.lookAt(Avatar.position),camera.position.copy(Avatar.position).sub(new THREE.Vector3(0,10,-10)))}function toggleCamera(){activeCamera=activeCamera==camera?outerCamera:camera}function update(){TWEEN.update()}function loop(){update(),renderer.render(scene,camera),window.requestAnimationFrame(loop)}function init(){var e=document.getElementById("container");(renderer=new THREE.WebGLRenderer({antialias:!0})).shadowMap.enabled=!0,renderer.shadowMap.type=THREE.PCSoftShadowMap,renderer.setPixelRatio(window.devicePixelRatio),renderer.setSize(window.innerWidth,window.innerHeight),renderer.setClearColor(12576767),e.appendChild(renderer.domElement),(camera=new THREE.PerspectiveCamera(70,window.innerWidth/window.innerHeight,1e-4,1e4)).position.set(0,5,10),camera.lookAt(new THREE.Vector3(0,0,0)),controls=new THREE.OrbitControls(camera,renderer.domElement),(scene=new Physijs.Scene).setGravity(new THREE.Vector3(0,-60,0)),scene.addEventListener("update",function(){scene.simulate(void 0,1)}),scene.add(camera);new THREE.Mesh(new THREE.SphereGeometry(.5),new THREE.MeshBasicMaterial({color:new THREE.Color(16711680)}));var n=new THREE.SpotLight(16777215,.15,0,.234,1,2);n.position.set(20,80,-36),n.castShadow=!0,n.shadow.mapSize.width=1024,n.shadow.mapSize.height=1024,n.shadow.camera.near=1,n.shadow.camera.far=200,n.shadow.camera.fov=30,scene.add(n);var a=new THREE.MeshStandardMaterial({color:16777215,emissive:16566509,metalness:0,roughness:0,side:THREE.DoubleSide});ground_material=Physijs.createMaterial(a,1,1),(ground=new Physijs.BoxMesh(new THREE.BoxGeometry(100,1,100),ground_material,0)).receiveShadow=!0,scene.add(ground);new THREE.Vector3(0,-5,0),new THREE.Vector3(-10,-5,0);for(var r in MODEL_DATA)if(MODEL_DATA.hasOwnProperty(r)){let e=CreateFruit(MODEL_DATA[r].geometry,MATERIALS.banana.clone());LOADED_OBJECTS[MODEL_DATA[r].key]=e}for(let e=0;e<ACTIVE_KEYS.length;e++){let n=ACTIVE_KEYS[e],a=e%4,r=10*(e/3-Math.floor(1.5)),o=10*(a-Math.floor(2)),t=LOADED_OBJECTS[n];t.mesh.position.set(r,0,o),scene.add(t.mesh),t.defineConstraint()}document.addEventListener("keydown",e=>{e.metaKey||e.preventDefault();let n=codeToKey(e.keyCode);if(n){let e=LOADED_OBJECTS[n];e&&e.play()}}),scene.simulate(),window.addEventListener("resize",resize),loop()}const KEYCODES={32:"spacebar",37:"left arrow",38:"up arrow",39:"right arrow",40:"down arrow",48:"0",49:"1",50:"2",51:"3",52:"4",53:"5",54:"6",55:"7",56:"8",57:"9",65:"a",66:"b",67:"c",68:"d",69:"e",70:"f",71:"g",72:"h",73:"i",74:"j",75:"k",76:"l",77:"m",78:"n",79:"o",80:"p",81:"q",82:"r",83:"s",84:"t",85:"u",86:"v",87:"w",88:"x",89:"y",90:"z"};var MODEL_DATA={banana:{geometry:null,materials:null,key:"q",sound:""},"banana-low":{geometry:null,materials:null,key:"w",sound:""},blueberry:{geometry:null,materials:null,key:"e",sound:""},banana_cube:{geometry:null,materials:null,key:"r",sound:""},apple:{geometry:null,materials:null,key:"a",sound:""},jelly:{geometry:null,materials:null,key:"s",sound:""}},TEXTURE_DATA={blueberry:null,apple:null,banana:null},MATERIALS={bubbleGum:new THREE.MeshStandardMaterial({color:new THREE.Color(16085695),emissive:new THREE.Color(9179688),roughness:.05,metalness:.48,side:THREE.DoubleSide,flatShading:!0,morphTargets:!0}),banana:new THREE.MeshPhongMaterial({color:new THREE.Color(16708701),emissive:new THREE.Color(16110671)}),blueberry:new THREE.MeshPhongMaterial({color:5766398,emissive:8295926,specular:5846099,shininess:27})};const LOADED_OBJECTS={},ACTIVE_KEYS=["q","w","e","r","a","s"];var modifier=new THREE.BufferSubdivisionModifier(4),CreateFruit=function(e,n,a,r){function o(){i.applyImpulse(s,l)}var t=Physijs.createMaterial(n,.8,.3),i=new Physijs.BoxMesh(e,t);i.castShadow=!0,i.scale.set(.5,.5,.5);var s=new THREE.Vector3(500,2200,800),l=new THREE.Vector3(1,5,2);return{applyImpulse:o,mesh:i,force:s,offset:l,play:function(){o()},defineConstraint:function(){var e=new THREE.Vector3(-1,-5,-1),n=new THREE.Vector3(1,15,1),a=new Physijs.DOFConstraint(i,null,i.position);scene.addConstraint(a),a.setLinearLowerLimit(e),a.setLinearUpperLimit(n)}}},CreateStaticCube=function(e,n){var a=new THREE.BoxGeometry(e,e,e),r=new THREE.MeshBasicMaterial({map:n}),o=new THREE.Mesh(a,r);return o.castShadow=!0,o.receiveShadow=!0,{mesh:o}};const ASSETS_PATH="assets/models/",TEXTURE_ASSETS_PATH="assets/images/";var Loader=function(){const e=new THREE.LoadingManager,n=new THREE.JSONLoader(e),a=new THREE.TextureLoader(e);return e.onProgress=function(e,n,a){console.log(e,n,a)},e.onLoad=function(){init()},this.loadModel=function(e){n.load(ASSETS_PATH+e+".json",function(n,a){MODEL_DATA[e].geometry=n,void 0!==a&&(MODEL_DATA[e].materials=a)})},this.loadTexture=function(e){a.load("assets/images/"+e+".png",function(n){TEXTURE_DATA[e]=n})},this}();for(var obj in MODEL_DATA)Loader.loadModel(obj);for(var key in TEXTURE_DATA)Loader.loadTexture(key);Physijs.scripts.worker="../lib/Physijs/physijs_worker.js",Physijs.scripts.ammo="examples/js/ammo.js";var initScene,render,box,loader,ground_material,ground,light,camera,outerCamera,scene,renderer,controls,pointLight,pov,domEvents,activeCamera,force,offset,clock=new THREE.Clock,boxes=[],fruits=[];